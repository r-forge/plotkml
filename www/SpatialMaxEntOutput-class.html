<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: A class for outputs of analysis produced using the dismo...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for SpatialMaxEntOutput-class {plotKML}"><tr><td>SpatialMaxEntOutput-class {plotKML}</td><td align="right">R Documentation</td></tr></table>

<h2>A class for outputs of analysis produced using the dismo package (MaxEnt)</h2>

<h3>Description</h3>

<p>A class containing input and output data produced by running the <code>maxent</code> (Maximum Entropy) species distribution modeling algorithm. Object of this class can be directly visualized in Google Earth by using the <code><a href="plotKML-method.html">plotKML-method</a></code>.</p>


<h3>Slots</h3>



<dl>
<dt><code>sciname</code>:</dt><dd><p>object of class <code>"character"</code>; vector of species name compatible with the <code>rgbif</code> package; usually latin &quot;genus&quot; and &quot;species&quot; name</p>
</dd>
<dt><code>occurrences</code>:</dt><dd><p>object of class <code>"SpatialPoints"</code>; occurrence-only records</p>
</dd>
<dt><code>TimeSpan.begin</code>:</dt><dd><p>object of class <code>"POSIXct"</code>; begin of the sampling period</p>
</dd>
<dt><code>TimeSpan.end</code>:</dt><dd><p>object of class <code>"POSIXct"</code>; end of the sampling period</p>
</dd>
<dt><code>maxent</code>:</dt><dd><p>object of class <code>"MaxEnt"</code> (species distribution model); produced as an output of the <code>dismo::maxent</code> function</p>
</dd>
<dt><code>sp.domain</code>:</dt><dd><p>object of class <code>"Spatial"</code> (ideally <code>"SpatialPolygonsDataFrame"</code> or <code>"SpatialPixelsDataFrame"</code>); assumed spatial domain that can be set by the user or it will be estimated by MaxEnt (see examples below)</p>
</dd>
<dt><code>predicted</code>:</dt><dd><p>object of class <code>"RasterLayer"</code>; contains results of prediction produced using the MaxEnt software</p>
</dd>
</dl>



<h3>Methods</h3>



<dl>
<dt>plotKML</dt><dd><p><code>signature(obj = "SpatialMaxEntOutput")</code>: plots all MaxEnt output objects in Google Earth</p>
</dd>
</dl>



<h3>Note</h3>

<p>MaxEnt requires the <code>maxent.jar</code> file to be in the 'java' folder of the dismo package (see: <code>system.file("java", package="dismo")</code>). For more info refer to the dismo package documentation.
</p>


<h3>Author(s)</h3>

<p> Tomislav Hengl </p>


<h3>References</h3>



<ul>
<li><p> Hijmans, R.J, Elith, J., (2012) <a href="http://cran.r-project.org/web/packages/dismo/vignettes/sdm.pdf">Species distribution modeling with R</a>. CRAN, Vignette for the dismo package, 72 p.  
</p>
</li>
<li><p> dismo package (<a href="http://CRAN.R-project.org/package=dismo">http://CRAN.R-project.org/package=dismo</a>)
</p>
</li>
<li><p> rgbif package (<a href="http://CRAN.R-project.org/package=rgbif">http://CRAN.R-project.org/package=rgbif</a>)
</p>
</li></ul>



<h3>See Also</h3>

 <p><code>dismo::maxent</code>, <code>rgbif::taxonsearch</code>, <code>GSIF::MaxEnt</code> 
</p>


<h3>Examples</h3>

<pre> 
# load occurences:
data(bigfoot)
aea.prj &lt;- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 
+x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"
coordinates(bigfoot) &lt;- ~Lon+Lat
proj4string(bigfoot) &lt;- CRS("+proj=latlon +datum=WGS84")
bigfoot.aea &lt;- spTransform(bigfoot, CRS(aea.prj))
# Load the covariates:
data(USAWgrids)
gridded(USAWgrids) &lt;- ~s1+s2
proj4string(USAWgrids) &lt;- CRS(aea.prj)
## Not run: # USA borders:
library(maps)
data(R_pal)
state.m = map('state', plot=FALSE, fill=TRUE)
IDs &lt;- sapply(strsplit(state.m$names, ":"), function(x) x[1])
library(maptools)
states &lt;- as(map2SpatialPolygons(state.m, IDs=IDs), "SpatialLines")
proj4string(states) &lt;- CRS("+proj=latlon +datum=NAD83")
states.aea &lt;- spTransform(states, CRS(aea.prj))
# subset to area of interest:
sel.ov &lt;- !is.na(overlay(USAWgrids, bigfoot.aea))
# run species distribution modelling:
sel.grids &lt;- c("globedem","nlights03","sdroads","gcarb","twi","globcov")
library(dismo)
# MaxEnt requires the maxent.jar file to run:
jar &lt;- paste(system.file(package="dismo"), "/java/maxent.jar", sep='')
if (file.exists(jar)) {
  predictors &lt;- stack(USAWgrids[sel.grids])
  # prepare the occurrence-only records:
  xy &lt;- data.frame(bigfoot.aea@coords[sel.ov,])
  # fit a MaxEnt model (can take few minutes!):
  me &lt;- maxent(predictors, xy, factors='globcov') # takes 1-2 mins;
  # predict distribution of Big Foot:
  bigfoot.pr &lt;- predict(me, predictors, progress='window')
  par(mfrow=c(1,2), mar=c(.5,.5,3.5,0.5), oma=c(0,0,0,0))
  image(bigfoot.pr, col=R_pal[["blue_grey_red"]], main='MaxEnt predictions', 
     axes = FALSE, xlab="", ylab="")
  rx &lt;- range(bigfoot.pr@data@values, na.rm=TRUE)
  rx &lt;- rev(as.character(round(c(rx[1],NA,mean(rx),NA,rx[2]), 2))) 
  legend("topleft", rx, fill=rev(R_pal[["blue_grey_red"]][c(1,5,10,15,20)]), 
     horiz=FALSE, cex=.6, bty="n")
  lines(states.aea)
  points(bigfoot.aea[sel.ov,], pch="+", cex=.7)
  # run cross-validation
  fold &lt;- kfold(xy, k=5)
  # randomly take 20
  xy.test &lt;- xy[fold == 1,]
  bg &lt;- randomPoints(predictors, 1000)  
  ev &lt;- evaluate(me, p=xy.test, a=bg, x=predictors)
  # this allows estimation of the threshold probability:
  threshold &lt;- ev@t[which.max(ev@TPR + ev@TNR)]
  # which allows us to derive the potential homerange for this species:
  image(bigfoot.pr &gt; threshold, col=c("wheat","green"), main='presence/absence', 
      axes = FALSE, xlab="", ylab="")
  lines(states.aea)
  dev.off()
  # prepare data for plotKML:
  hr &lt;- calc(bigfoot.pr, fun=function(x){ifelse(x&gt;threshold, 1, NA)})
  bigfoot.hr &lt;- rasterToPolygons(hr, dissolve=TRUE) # takes 3-4 mins!
  occ &lt;- SpatialPoints(bigfoot.aea[sel.ov,]); proj4string(occ) = CRS(aea.prj)
  # create an object of type "SpatialMaxEntOutput":
  bigfoot.smo &lt;- new("SpatialMaxEntOutput", sciname = "Sasquatch", occurrences = occ, 
     TimeSpan.begin = min(bigfoot@data[sel.ov,"DATE"]), 
     TimeSpan.end = max(bigfoot@data[sel.ov,"DATE"]), 
     maxent = me, sp.domain = bigfoot.hr, predicted = bigfoot.pr)
  # str(bigfoot.smo, max.level=2)
  # plot the whole SDM project in Google Earth:
  data(R_pal)
  icon = "http://plotkml.r-forge.r-project.org/bigfoot.png"
  plotKML(bigfoot.smo, colour_scale = R_pal[["bpy_colors"]], shape = icon)
}

## End(Not run)
</pre>

<hr><div align="center">[Package <em>plotKML</em> version 0.3-0 <a href="00Index.html">Index</a>]</div>
</body></html>
